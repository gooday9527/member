<!-- login.html -->
<h3 class="text-center">ğŸ” ç™»å…¥</h3>
<form id="loginForm" class="text-center mt-3" style="max-width: 400px; margin: auto;">
    <div class="mb-3">
        <input type="email" id="loginEmail" class="form-control" placeholder="Email" required />
    </div>
    <div class="mb-3">
        <input type="password" id="loginPassword" class="form-control" placeholder="å¯†ç¢¼" required />
    </div>
    <button type="submit" class="btn btn-warning w-100 mb-3">ç™»å…¥</button>

    <div class="d-flex justify-content-between gap-2">
        <a href="reset-password.html" class="btn btn-danger w-100">å¿˜è¨˜å¯†ç¢¼ï¼Ÿ</a>
        <a href="register.html" class="btn btn-primary w-100">è¨»å†Šæ–°å¸³è™Ÿ</a>
    </div>
</form>
<!-- ç›¸é—œ JavaScript é‚è¼¯å°‡æœƒå¾ index.html ç§»åˆ°é€™è£¡ -->
<script type="module">
    // é€™è£¡éœ€è¦é‡æ–°åˆå§‹åŒ– Firebaseï¼Œå› ç‚ºé€™å€‹ HTML æ˜¯ç¨ç«‹è¼‰å…¥çš„
    // ä¸¦ç¢ºä¿ç²å– auth å¯¦ä¾‹
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js';
    import { getAuth, signInWithEmailAndPassword } from 'https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js';

    const firebaseConfig = {
        apiKey: "AIzaSyD9Bt0HwGGwlRT3_CWFBDhjGcnYf5lCuZU",
        authDomain: "goodaymember.firebaseapp.com",
        projectId: "goodaymember",
        storageBucket: "goodaymember.appspot.com",
        messagingSenderId: "730801053598",
        appId: "1:730801053598:web:a2ec0dc91c78fef6bfc08f",
        measurementId: "G-J3Z7YTHJ9P"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    document.addEventListener("DOMContentLoaded", function() {
        // ç™»å…¥è¡¨å–®æäº¤äº‹ä»¶è™•ç†
        document.getElementById("loginForm")?.addEventListener("submit", function (e) {
            e.preventDefault();
            const email = document.getElementById("loginEmail").value.trim();
            const password = document.getElementById("loginPassword").value;

            signInWithEmailAndPassword(auth, email, password)
                .then((userCredential) => {
                    const user = userCredential.user;
                    console.log("ç™»å…¥æˆåŠŸ", user.email);
                    // å‘¼å« index.html ä¸­çš„å…¨å±€å‡½æ•¸ä¾†æ›´æ–°ä¸»é é¢ç‹€æ…‹
                    if (window.updateMainAppLoginState) {
                        window.updateMainAppLoginState(user.email);
                    }
                    alert("âœ… ç™»å…¥æˆåŠŸï¼");
                })
                .catch((error) => {
                    console.error("ç™»å…¥å¤±æ•—", error);
                    alert("ç™»å…¥å¤±æ•—ï¼š" + error.message);
                });
        });
    });
</script>
