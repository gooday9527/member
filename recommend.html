<!-- recommend.html -->
<h3 class="text-center">ğŸŒŸ æ¨è–¦æ¸…å–®</h3>
<div class="mb-3 d-flex align-items-center gap-2">
    <label for="recommendSheet" class="form-label mb-0">é¸æ“‡åˆ†é¡ï¼š</label>
    <select id="recommendSheet" class="form-select form-select-sm" style="max-width: 200px;">
        <option value="æˆ‘å…¨éƒ½è¦ï¼ˆä¸éœ€è­‰ä»¶ï¼‰">æˆ‘å…¨éƒ½è¦ï¼ˆä¸éœ€è­‰ä»¶ï¼‰</option>
        <option value="é«˜cpæ¨è–¦">é«˜cpæ¨è–¦</option>
        <option value="ç¦®åˆ¸é¡">ç¦®åˆ¸é¡</option>
        <option value="å°è³‡æ—">å°è³‡æ—</option>
        <option value="å…¥é–€çµ„">å…¥é–€çµ„</option>
    </select>
</div>
<div class="mt-3 table-responsive">
    <table class="table table-bordered table-sm" id="recommendTable">
        <thead class="table-warning"></thead>
        <tbody></tbody>
    </table>
</div>
<!-- ç›¸é—œ JavaScript é‚è¼¯å°‡æœƒå¾ index.html ç§»åˆ°é€™è£¡ -->
<script>
    // æ¨è–¦æ¸…å–®è¼‰å…¥é‚è¼¯
    function loadRecommend(sheetName) {
        const url = `https://opensheet.elk.sh/1WNSOI3l4AVk2h1kY0qj7xu4-9YdU_2fEj8xUf7lUSZk/${encodeURIComponent(sheetName)}`;
        fetch(url)
            .then(res => res.json())
            .then(data => {
                const tableElement = document.getElementById('recommendTable');
                if (tableElement) {
                    tableElement.querySelector('thead').innerHTML = ''; tableElement.querySelector('tbody').innerHTML = '';
                    if (data && data.length > 0) {
                        const headers = Object.keys(data[0]);
                        const thead = headers.map(h => `<th>${h}</th>`).join('');
                        const tbody = data.map(row => `<tr>${headers.map(k => `<td>${row[k]|| ''}</td>`).join('')}</tr>`).join('');
                        tableElement.querySelector('thead').innerHTML = `<tr>${thead}</tr>`;
                        tableElement.querySelector('tbody').innerHTML = tbody;
                    } else {
                        tableElement.querySelector('thead').innerHTML = ''; tableElement.querySelector('tbody').innerHTML = '<tr><td colspan="100%">æ²’æœ‰å¯ç”¨çš„è³‡æ–™</td></tr>';
                    }
                }
            })
            .catch(error => console.error('è¼‰å…¥æ¨è–¦æ¸…å–®è³‡æ–™æ™‚ç™¼ç”ŸéŒ¯èª¤:', error));
    }

    // åœ¨é é¢è¼‰å…¥åˆ° DOM å¾Œç«‹å³åŸ·è¡Œ
    document.addEventListener('DOMContentLoaded', () => {
        const recommendSheetSelect = document.getElementById('recommendSheet');
        if (recommendSheetSelect) {
            recommendSheetSelect.addEventListener('change', function () {
                loadRecommend(this.value);
            });
            loadRecommend('æˆ‘å…¨éƒ½è¦ï¼ˆä¸éœ€è­‰ä»¶ï¼‰'); // é è¨­è¼‰å…¥
        }
    });
</script>
