<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>å¥½ç®¡å®¶è‚¡æ±ç´€å¿µå“ä»£é ˜</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.13.10/css/jquery.dataTables.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.13.10/css/dataTables.bootstrap5.min.css"/> 

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <style>
        /* ç¢ºä¿æ‰€æœ‰ä¸»æ¨™é¡Œ (ç´€å¿µå“ã€æ¨è–¦æ¸…å–®ã€æ³¨æ„äº‹é …ã€é—œæ–¼æˆ‘) æ–‡æœ¬å±…ä¸­é¡¯ç¤º */
        #souvenir h3, #recommend h3, #notice h3, #about h3 {
            text-align: center;
        }

        /* ----- å¾æ‚¨æä¾›çš„ style.css ä¸­è¤‡è£½ä¸¦å¾®èª¿çš„éƒ¨åˆ† ----- */
        /* è¨­å®š body çš„åŸºæœ¬æ¨£å¼ï¼šèƒŒæ™¯é¡è‰²ã€å­—é«”ã€é‚Šè·å’Œé˜²æ­¢æ©«å‘æ»¾å‹• */
        body {
            background-color: #fffbea; /* æ·ºé»ƒè‰²èƒŒæ™¯ */
            font-family: 'Noto Sans TC', sans-serif; /* ä½¿ç”¨æ€æºé»‘é«” (æˆ–å…¶ä»–ç„¡è¥¯ç·šå­—é«”) */
            margin: 0; /* ç§»é™¤é è¨­å¤–é‚Šè· */
            padding: 0; /* ç§»é™¤é è¨­å…§é‚Šè· */
            overflow-x: hidden; /* é˜²æ­¢é é¢å‡ºç¾æ°´å¹³æ»¾å‹•æ¢ï¼Œå³ä¾¿æ˜¯å…§å®¹æº¢å‡ºä¹Ÿä¸æœƒæ©«å‘æ»¾å‹• */
        }

        /* å°è¦½åˆ— (navbar) çš„æ¨£å¼ */
        .navbar {
            background-color: #ffe082; /* å°è¦½åˆ—èƒŒæ™¯é¡è‰² */
            padding-left: 1rem; /* å·¦å…§é‚Šè· */
            padding-right: 1rem; /* å³å…§é‚Šè· */
        }

        /* å°è¦½åˆ—é€£çµçš„æ¨£å¼ */
        .nav-link {
            font-weight: bold; /* å­—é«”åŠ ç²— */
        }

        /* ç•¶å°è¦½åˆ—é€£çµè™•æ–¼æ´»å‹• (active) ç‹€æ…‹æ™‚çš„æ¨£å¼ */
        .nav-link.active {
            color: #007bff; /* æ–‡æœ¬é¡è‰²ç‚ºè—è‰² */
            font-weight: bold; /* å­—é«”åŠ ç²— */
            border-bottom: 2px solid #007bff; /* åº•éƒ¨æ·»åŠ è—è‰²é‚Šæ¡†ï¼Œå½¢æˆå¼·èª¿æ•ˆæœ */
        }

        /* å…§å®¹å®¹å™¨ (container-fluid) çš„æ¨£å¼ */
        .container-fluid {
            padding-left: 1rem !important; /* å·¦å…§é‚Šè·ï¼Œä½¿ç”¨ !important ç¢ºä¿è¦†è“‹ Bootstrap é è¨­æ¨£å¼ */
            padding-right: 1rem !important; /* å³å…§é‚Šè·ï¼Œä½¿ç”¨ !important ç¢ºä¿è¦†è“‹ Bootstrap é è¨­æ¨£å¼ */
            position: relative; /* è¨­ç½®ç‚ºç›¸å°å®šä½ï¼Œä»¥ä¾¿å…§éƒ¨çµ•å°å®šä½çš„ section ç›¸å°å…¶å®šä½ */
            min-height: 600px; /* æœ€å°é«˜åº¦ï¼Œé˜²æ­¢å…§å®¹éå°‘æ™‚é é¢éçŸ­ï¼Œå¯æ ¹æ“šå¯¦éš›å…§å®¹èª¿æ•´æˆ–ç§»é™¤ */
            padding-top: 3rem; /* é ‚éƒ¨å…§é‚Šè· */
            padding-bottom: 3rem; /* åº•éƒ¨å…§é‚Šè· */
        }

        /* å…§å®¹å€å¡Š (section) çš„é¡¯ç¤º/éš±è—å’Œå±¤ç–Šæ¨£å¼ */
        .section {
            display: none; /* é è¨­ä¸é¡¯ç¤ºæ‰€æœ‰ section */
            position: absolute; /* è¨­ç½®ç‚ºçµ•å°å®šä½ï¼Œä½¿å…¶è„«é›¢æ–‡æª”æµï¼Œä¾¿æ–¼ç–ŠåŠ é¡¯ç¤º */
            width: calc(100% - 2rem); /* å¯¬åº¦è¨ˆç®—ï¼šå®¹å™¨å¯¬åº¦æ¸›å»å·¦å³å„ 1rem çš„ padding */
            top: 1rem; /* è·é›¢ container-fluid é ‚éƒ¨çš„åç§» */
            left: 1rem; /* è·é›¢ container-fluid å·¦å´çš„åç§» */
            right: 1rem; /* è·é›¢ container-fluid å³å´çš„åç§» (é…åˆ left å’Œ width ç¢ºä¿å¡«å……) */
        }

        /* åªæœ‰ç•¶ section æ“æœ‰ active-section é¡åˆ¥æ™‚æ‰é¡¯ç¤ºå®ƒ */
        .section.active-section {
            display: block; /* é¡¯ç¤ºè©²å€å¡Š */
            z-index: 10; /* å°‡å…¶ Z-index è¨­ç½®ç‚ºæ›´é«˜ï¼Œç¢ºä¿å…¶ç–ŠåŠ åœ¨å…¶ä»–éš±è—çš„ section ä¹‹ä¸Š */
        }

        /* ===== è¡¨æ ¼æ¨£å¼ ===== */
        /* è¡¨æ ¼çš„åŸºç¤æ¨£å¼ */
        table {
            border-collapse: collapse; /* é‚Šæ¡†åˆä½µ */
            width: 100%; /* å¯¬åº¦ä½”æ»¿çˆ¶å®¹å™¨ */
            word-wrap: break-word; /* é•·å–®è©è‡ªå‹•æ›è¡Œ */
        }

        /* è¡¨é ­å–®å…ƒæ ¼ (<th>) çš„æ¨£å¼ */
        th {
            white-space: normal; /* è¡¨é ­æ–‡å­—è‡ªå‹•æ›è¡Œ */
            text-align: left; /* æ–‡å­—å·¦å°é½Š */
            background-color: #fff3cd; /* èƒŒæ™¯é¡è‰² */
            padding: 0.5rem; /* å…§é‚Šè· */
            vertical-align: middle; /* å‚ç›´å±…ä¸­å°é½Š */
            border: 1px solid #dee2e6; /* é‚Šæ¡†æ¨£å¼ */
        }

        /* è¡¨æ ¼æ•¸æ“šå–®å…ƒæ ¼ (<td>) çš„æ¨£å¼ */
        td {
            white-space: normal; /* æ­£å¸¸æ›è¡Œ */
            text-align: left; /* æ–‡å­—å·¦å°é½Š */
            padding: 0.5rem; /* å…§é‚Šè· */
            vertical-align: middle; /* å‚ç›´å±…ä¸­å°é½Š */
            border: 1px solid #dee2e6; /* é‚Šæ¡†æ¨£å¼ */
        }

        /* æ¨è–¦åˆ†é¡ä¸‹æ‹‰é¸å–®çš„å¯¬åº¦é™åˆ¶ */
        #recommendSheet {
            max-width: 250px; /* ä¸‹æ‹‰é¸å–®æœ€å¤§å¯¬åº¦ */
        }

        /* DataTables ç›¸é—œçš„è‡ªè¨‚æ¨£å¼ */
        /* ä¿ç•™åŸæœ¬é‡å° .dataTables_length select çš„æ¨£å¼ï¼Œç¢ºä¿å…¶å¯¬åº¦æ­£å¸¸ */
        .dataTables_wrapper .dataTables_length select {
            min-width: 80px; 
            width: auto; 
            display: inline-block; 
        }
        .dataTables_wrapper .dataTables_length, 
        .dataTables_wrapper .dataTables_filter { 
            margin-bottom: 18px; 
        }
        .dataTables_wrapper .dataTables_info, 
        .dataTables_wrapper .dataTables_paginate { 
            margin-top: 12px; 
            font-size: 1.1rem; 
        }

        /* é‡å° DataTables åˆ†é æŒ‰éˆ•çš„æ›´ç²¾ç¢ºæ¨£å¼è¦†è“‹ */
        /* å¼·åˆ¶é‡ç½®æ‰€æœ‰ paginate_button ç›¸é—œçš„é‚Šæ¡†ã€èƒŒæ™¯ã€é™°å½±å’Œåœ“è§’ */
        .dataTables_wrapper .dataTables_paginate .paginate_button,
        .dataTables_wrapper .dataTables_paginate .paginate_button.current,
        .dataTables_wrapper .dataTables_paginate .paginate_button.current:hover,
        .dataTables_wrapper .dataTables_paginate .paginate_button.disabled,
        .dataTables_wrapper .dataTables_paginate .paginate_button:hover,
        .dataTables_wrapper .dataTables_paginate .paginate_button.active { /* æ·»åŠ  .active */
            border: none !important;                /* å¾¹åº•ç§»é™¤æ‰€æœ‰é‚Šæ¡† */
            background-color: transparent !important; /* ç¢ºä¿èƒŒæ™¯æ˜¯é€æ˜çš„ */
            background-image: none !important;      /* ç§»é™¤ä»»ä½•èƒŒæ™¯åœ–ç‰‡ */
            box-shadow: none !important;            /* å¾¹åº•ç§»é™¤æ‰€æœ‰é™°å½± */
            padding: 0.5em 0.8em !important;        /* ä¿æŒé©ç•¶çš„é–“è·ï¼Œæ‚¨å¯ä»¥å¾®èª¿ */
            margin: 0 2px !important;               /* é ç¢¼ä¹‹é–“çš„å°é–“è· */
            border-radius: 0 !important;            /* ç§»é™¤æ‰€æœ‰åœ“è§’ */
            cursor: pointer;                        /* ç¢ºä¿å¯é»æ“Šçš„é ç¢¼æœ‰é¼ æ¨™æŒ‡é‡ */
        }

        /* é‡å°ç•¶å‰é ç¢¼çš„æ–‡å­—é¡è‰²å’Œæ¨£å¼ */
        .dataTables_wrapper .dataTables_paginate .paginate_button.current {
            color: #0d6efd !important; /* ç•¶å‰é ç¢¼çš„æ–‡å­—é¡è‰²ï¼Œä¾‹å¦‚ Bootstrap primary è—è‰² */
            font-weight: bold !important; /* åŠ ç²—ç•¶å‰é ç¢¼ */
            text-decoration: underline !important; /* ç•¶å‰é ç¢¼å¯ä»¥åŠ åº•ç·šå¼·èª¿ */
        }

        /* é‡å°éç•¶å‰é ç¢¼çš„æ–‡å­—é¡è‰² */
        .dataTables_wrapper .dataTables_paginate .paginate_button:not(.current):not(.disabled) {
            color: #495057 !important; /* éç•¶å‰é ç¢¼çš„æ–‡å­—é¡è‰²ï¼Œä¾‹å¦‚æ·±ç°è‰² */
        }

        /* é‡å°éç•¶å‰é ç¢¼åœ¨ hover æ™‚çš„æ¨£å¼ */
        .dataTables_wrapper .dataTables_paginate .paginate_button:not(.current):not(.disabled):hover {
            color: #0a58ca !important; /* hover æ™‚çš„æ–‡å­—é¡è‰² */
            text-decoration: underline !important; /* hover æ™‚æ·»åŠ åº•ç·š */
        }
        
        /* é‡å°ç¦ç”¨ç‹€æ…‹çš„æŒ‰éˆ•ï¼ˆä¾‹å¦‚ã€Œä¸Šä¸€é ã€ã€Œä¸‹ä¸€é ã€åœ¨é¦–å°¾æ™‚ï¼‰ */
        .dataTables_wrapper .dataTables_paginate .paginate_button.disabled {
            color: #6c757d !important; /* ç¦ç”¨ç‹€æ…‹çš„é¡è‰² */
            cursor: not-allowed; /* ç¦ç”¨æ™‚é¡¯ç¤ºä¸å¯é»æ“Šçš„é¼ æ¨™ */
        }

        /* ç¢ºä¿ DataTables ç”Ÿæˆçš„è¡¨é ­å’Œå…§å®¹å®¹å™¨å°é½Š */
        /* DataTables æœƒç”Ÿæˆé¡å¤–çš„ div ä¾†åŒ…è£¹è¡¨é ­å’Œè¡¨èº«ï¼Œç‚ºäº†ç¢ºä¿å®ƒå€‘çš„å°é½Šï¼Œéœ€è¦èª¿æ•´é€™äº› div çš„å¯¬åº¦ */
        .dataTables_scrollHeadInner, .dataTables_scrollBody {
            width: 100% !important; /* å¼·åˆ¶ DataTables å…§éƒ¨æ»¾å‹•å®¹å™¨å¯¬åº¦ç‚º 100% */
        }
        .dataTables_scrollHead table, .dataTables_scrollBody table {
            width: 100% !important; /* å¼·åˆ¶ DataTables å…§éƒ¨å¯¦éš›è¡¨æ ¼å¯¬åº¦ç‚º 100% */
            margin-bottom: 0 !important; /* ç§»é™¤åº•éƒ¨ä¸å¿…è¦çš„é–“è· */
        }
        /* è™•ç†å¯èƒ½ç”± DataTables å…§è¯æ¨£å¼å¼•èµ·çš„å•é¡Œï¼Œç¢ºä¿æœå°‹æ¡†å’Œé¡¯ç¤ºæ¢ç›®æ•¸çš„ä½ˆå±€ */
        div.dataTables_wrapper div.dataTables_filter label,
        div.dataTables_wrapper div.dataTables_length label {
            display: flex; /* ä½¿ç”¨ Flexbox ä½ˆå±€ */
            align-items: center; /* å‚ç›´å±…ä¸­å°é½Š */
            gap: 0.5em; /* å…ƒç´ ä¹‹é–“çš„é–“è· */
        }
        div.dataTables_wrapper div.dataTables_filter input {
            box-sizing: border-box; /* é‚Šæ¡†ç›’æ¨¡å‹ï¼Œç¢ºä¿ padding ä¸æœƒå¢åŠ å¯¬åº¦ */
            max-width: 100%; /* æœ€å¤§å¯¬åº¦ç‚º 100% */
            width: auto; /* å¯¬åº¦è‡ªå‹•èª¿æ•´ */
        }


        /* æ‰‹æ©Ÿç‰ˆ (å°æ–¼æˆ–ç­‰æ–¼ 768px å¯¬åº¦) çš„éŸ¿æ‡‰å¼æ¨£å¼ */
        @media only screen and (max-width: 768px) {
            body { padding: 10px; } /* èª¿æ•´ body çš„æ•´é«”å…§é‚Šè· */
            h3 { font-size: 1.5rem; margin-bottom: 10px; } /* ç¸®å°æ¨™é¡Œå­—é«”å¤§å°å’Œä¸‹é‚Šè· */
            .dataTables_wrapper .dataTables_length, 
            .dataTables_wrapper .dataTables_filter {
                margin-bottom: 12px; /* èª¿æ•´æ‰‹æ©Ÿç‰ˆ DataTables æ§ä»¶çš„ä¸‹é‚Šè· */
            }
            .dataTables_wrapper .dataTables_info, 
            .dataTables_wrapper .dataTables_paginate {
                margin-top: 12px; /* èª¿æ•´æ‰‹æ©Ÿç‰ˆ DataTables è³‡è¨Šå’Œåˆ†é çš„ä¸Šé‚Šè· */
                font-size: 0.9rem; /* ç¸®å°æ‰‹æ©Ÿç‰ˆ DataTables è³‡è¨Šå’Œåˆ†é çš„å­—é«”å¤§å° */
            }
            .table td { 
                font-size: 14px; /* ç¸®å°æ‰‹æ©Ÿç‰ˆè¡¨æ ¼æ•¸æ“šçš„å­—é«”å¤§å° */
            }
            .table th, .table td { 
                padding: 6px 3px; /* ç¸®å°æ‰‹æ©Ÿç‰ˆè¡¨æ ¼å–®å…ƒæ ¼çš„å…§é‚Šè· */
            }

            /* ç¢ºä¿æ‰‹æ©Ÿç‰ˆå°è¦½åˆ—çš„æ¼¢å ¡æŒ‰éˆ•å¯è¦‹ä¸¦æ­£å¸¸å·¥ä½œ */
            .navbar-toggler {
                display: block; /* ç¢ºä¿æ¼¢å ¡æŒ‰éˆ•åœ¨æ‰‹æ©Ÿç‰ˆé¡¯ç¤º */
                border: 1px solid rgba(0,0,0,.1); /* æ¼¢å ¡æŒ‰éˆ•é‚Šæ¡† */
            }
            /* è®“å°è¦½åˆ—å…§å®¹åœ¨æ‰‹æ©Ÿä¸Šå †ç–Š (å‚ç›´æ’åˆ—) */
            .navbar-collapse {
                flex-grow: 1; 
                flex-basis: 100%; 
                margin-top: 0.5rem; 
            }
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-md navbar-light"> 
        <a class="navbar-brand fw-bold" href="#">å¥½ç®¡å®¶ä»£é ˜</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav"> 
            <ul class="navbar-nav me-auto mb-2 mb-lg-0" id="navMenu">
                </ul>
        </div>
    </nav>

    <div class="container-fluid">
        <section id="souvenir" class="section active-section">
            <h3 class="text-center">ğŸ ç´€å¿µå“</h3> 
            <div class="mt-3"> 
                <table class="table table-bordered table-sm" id="souvenirTable">
                    <thead class="table-warning"></thead> <tbody></tbody> </table>
            </div>
        </section>

        <section id="recommend" class="section"> 
            <h3 class="text-center">ğŸŒŸ æ¨è–¦æ¸…å–®</h3> 
            <div class="mb-3 d-flex align-items-center gap-2">
                <label for="recommendSheet" class="form-label mb-0">é¸æ“‡åˆ†é¡ï¼š</label>
                <select id="recommendSheet" class="form-select form-select-sm" style="max-width: 300px;">
                    <option value="æˆ‘å…¨éƒ½è¦ï¼ˆä¸éœ€è­‰ä»¶ï¼‰">æˆ‘å…¨éƒ½è¦ï¼ˆä¸éœ€è­‰ä»¶ï¼‰</option>
                    <option value="é«˜cpæ¨è–¦">é«˜cpæ¨è–¦</option>
                    <option value="ç¦®åˆ¸é¡">ç¦®åˆ¸é¡</option>
                    <option value="å°è³‡æ—">å°è³‡æ—</option>
                    <option value="å…¥é–€çµ„">å…¥é–€çµ„</option>
                    <option value="æˆ‘å…¨éƒ½è¦ï¼ˆä¸éœ€è­‰ä»¶ï¼‰">æˆ‘å…¨éƒ½è¦ï¼ˆä¸éœ€è­‰ä»¶ï¼‰</option>
                </select>
            </div>
            <div class="mt-3">
                <table class="table table-bordered table-sm" id="recommendTable">
                    <thead class="table-warning"></thead> <tbody></tbody> </table>
            </div>
        </section>

        <section id="notice" class="section">
            <h3 class="text-center">ğŸ“Œ æ³¨æ„äº‹é …</h3> 
            <p>æœ¬æœå‹™ç‚ºå¥½ç®¡å®¶åœ˜éšŠæä¾›ä¹‹è‚¡æ±ç´€å¿µå“ä»£é ˜å¹³å°ï¼Œè«‹ç¢ºèªè³‡æ–™æ­£ç¢ºæ€§å¾Œå†é€²è¡Œç™»è¨˜ã€‚</p>
        </section>

        <section id="about" class="section">
            <h3 class="text-center">ğŸ‘¤ é—œæ–¼æˆ‘å€‘</h3> 
            <p>ç´€å¿µå“ä»£é ˜ï¼Œçœæ™‚åˆçœåŠ›ï¼Œå¸Œæœ›å¹«åŠ©å¤§å®¶ç°¡åŒ–ç´€å¿µå“é ˜å–æµç¨‹ã€‚</p>
        </section>
    </div>

    <script type="text/javascript" src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script type="text/javascript" src="https://cdn.datatables.net/1.13.10/js/jquery.dataTables.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/1.13.10/js/dataTables.bootstrap5.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/js/all.min.js" integrity="sha512-J/0uB3zIgK1t5OJAA7Js1qntoZ1aI7V3C2aygtlNt9rSAbRRxvKakIDhMKRcX7gs3PEz+XRTS1G0BqT/91Q56A==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <script type="module">
        // å¾ Firebase SDK å°å…¥å¿…è¦çš„æ¨¡å¡Š
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js';
        import { getAuth, onAuthStateChanged, signOut } from 'https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js';

        // Firebase å°ˆæ¡ˆé…ç½®ä¿¡æ¯ (è«‹æ›¿æ›ç‚ºæ‚¨çš„å¯¦éš›é…ç½®)
        const firebaseConfig = {
            apiKey: "AIzaSyD9Bt0HwGGwlRT3_CWFBDhjGcnYf5lCuZU",
            authDomain: "goodaymember.firebaseapp.com",
            projectId: "goodaymember",
            storageBucket: "goodaymember.appspot.com",
            messagingSenderId: "730801053598",
            appId: "1:730801053598:web:a2ec0dc91c78fef6bfc08f",
            measurementId: "G-J3Z7YTHJ9P"
        };

        // åˆå§‹åŒ– Firebase æ‡‰ç”¨å’Œèªè­‰æœå‹™
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        let loginEmail = null; // ç”¨æ–¼å„²å­˜ç•¶å‰ç™»å…¥ç”¨æˆ¶çš„éƒµç®±ï¼Œé è¨­ç‚ºç©º (æœªç™»å…¥)
        const navMenu = document.getElementById("navMenu"); // ç²å–å°è¦½åˆ—èœå–®çš„ DOM å…ƒç´ 
        const allSections = document.querySelectorAll(".section"); // ç²å–æ‰€æœ‰å…§å®¹å€å¡Šçš„ DOM å…ƒç´ 

        // æœªç™»å…¥ç‹€æ…‹ä¸‹å°è¦½åˆ—é¡¯ç¤ºçš„é¸é …
        const tabsBeforeLogin = [
            { id: "souvenir", label: "ç´€å¿µå“" },
            { id: "recommend", label: "æ¨è–¦æ¸…å–®" },
            { id: "notice", label: "æ³¨æ„äº‹é …" },
            { id: "about", label: "é—œæ–¼æˆ‘" },
            { id: "register", label: "è¨»å†Š", link: "register.html" }, // å¤–éƒ¨é€£çµ
            { id: "login", label: "ç™»å…¥", link: "login.html" } // å¤–éƒ¨é€£çµ
        ];

        // ç™»å…¥ç‹€æ…‹ä¸‹å°è¦½åˆ—é¡¯ç¤ºçš„é¸é …
        const tabsAfterLogin = [
            { id: "souvenir", label: "ç´€å¿µå“" },
            { id: "recommend", label: "æ¨è–¦æ¸…å–®" },
            { id: "notice", label: "æ³¨æ„äº‹é …" },
            { id: "about", label: "é—œæ–¼æˆ‘" },
            { id: "account", label: "æ–°å¢å¸³è™Ÿ/æŒè‚¡" },
            { id: "delegation", label: "å¯å§”è¨—" },
            { id: "delegated", label: "å·²å§”è¨—" },
            { id: "announcement", label: "å…¬å‘Šæ¬„" },
            { id: "souvenir-manage", label: "ç´€å¿µå“ç®¡ç†" },
            { id: "billing", label: "å¸³æˆ¶ç®¡ç†" },
            { id: "logout", label: "ç™»å‡º" } // ç™»å‡ºåŠŸèƒ½
        ];

        // æ ¹æ“šç™»å…¥ç‹€æ…‹æ¸²æŸ“å°è¦½åˆ—èœå–®
        function renderNavTabs() {
            navMenu.innerHTML = ""; // æ¸…ç©ºç¾æœ‰èœå–®å…§å®¹
            const tabs = loginEmail ? tabsAfterLogin : tabsBeforeLogin; // æ ¹æ“šç™»å…¥ç‹€æ…‹é¸æ“‡è¦é¡¯ç¤ºçš„èœå–®
            tabs.forEach(tab => {
                const li = document.createElement("li"); // å‰µå»ºåˆ—è¡¨é …å…ƒç´ 
                li.className = "nav-item"; // æ·»åŠ  Bootstrap å°è¦½åˆ—é …ç›®çš„é¡åˆ¥
                if (tab.link) {
                    // å¦‚æœæœ‰å¤–éƒ¨é€£çµï¼Œå‰‡å‰µå»ºä¸€å€‹æ™®é€šé€£çµ
                    li.innerHTML = `<a class="nav-link" href="${tab.link}">${tab.label}</a>`;
                } else {
                    // å¦‚æœæ˜¯å…§éƒ¨å€å¡Šåˆ‡æ›ï¼Œå‰‡å‰µå»ºä¸€å€‹å¸¶æœ‰ data-section å±¬æ€§çš„é€£çµ
                    li.innerHTML = `<a class="nav-link" href="#" data-section="${tab.id}">${tab.label}</a>`;
                }
                navMenu.appendChild(li); // å°‡åˆ—è¡¨é …æ·»åŠ åˆ°å°è¦½åˆ—èœå–®ä¸­
            });
        }

        // é¡¯ç¤ºæŒ‡å®šçš„å…§å®¹å€å¡Š
        function showSection(id) {
            allSections.forEach(sec => sec.classList.remove("active-section")); // ç§»é™¤æ‰€æœ‰å€å¡Šçš„ active-section é¡åˆ¥ï¼Œéš±è—å®ƒå€‘
            const target = document.getElementById(id); // ç²å–ç›®æ¨™å€å¡Šçš„ DOM å…ƒç´ 
            if (target) {
                target.classList.add("active-section"); // ç‚ºç›®æ¨™å€å¡Šæ·»åŠ  active-section é¡åˆ¥ï¼Œä½¿å…¶é¡¯ç¤º
                // ç§»é™¤æ‰€æœ‰å°è¦½åˆ—é€£çµçš„ active é¡åˆ¥
                document.querySelectorAll('.nav-link').forEach(link => {
                    link.classList.remove('active');
                });
                // ç‚ºç•¶å‰æ´»å‹•å€å¡Šå°æ‡‰çš„å°è¦½åˆ—é€£çµæ·»åŠ  active é¡åˆ¥
                const activeNavLink = document.querySelector(`.nav-link[data-section="${id}"]`);
                if (activeNavLink) {
                    activeNavLink.classList.add('active');
                }
            }
            // ç”±æ–¼å°è¦½åˆ—æ˜¯å–®é æ‡‰ç”¨åˆ‡æ›ï¼Œç¢ºä¿åœ¨é»æ“Šå°è¦½åˆ—é€£çµå¾Œæ”¶èµ·å°è¦½åˆ— (ç‰¹åˆ¥æ˜¯æ‰‹æ©Ÿç‰ˆ)
            const navbarCollapse = document.getElementById('navbarNav');
            const bsCollapse = bootstrap.Collapse.getInstance(navbarCollapse); // ç²å– Bootstrap çš„æŠ˜ç–Šå¯¦ä¾‹
            if (bsCollapse && navbarCollapse.classList.contains('show')) {
                bsCollapse.hide(); // å¦‚æœå°è¦½åˆ—è™•æ–¼å±•é–‹ç‹€æ…‹ï¼Œå‰‡æ”¶èµ·å®ƒ
            }
        }

        // ç›£è½å°è¦½åˆ—èœå–®çš„é»æ“Šäº‹ä»¶
        navMenu.addEventListener("click", function (e) {
            // æŸ¥æ‰¾æœ€è¿‘çš„å¸¶æœ‰ data-section å±¬æ€§çš„ .nav-link å…ƒç´ 
            const clickedNavLink = e.target.closest(".nav-link[data-section]");
            if (clickedNavLink) {
                e.preventDefault(); // é˜»æ­¢é€£çµçš„é è¨­è¡Œç‚º (è·³è½‰é é¢)
                const id = clickedNavLink.getAttribute("data-section"); // ç²å– data-section çš„å€¼
                if (id === "logout") {
                    // å¦‚æœé»æ“Šçš„æ˜¯ç™»å‡ºé€£çµ
                    signOut(auth).then(() => {
                        // ç™»å‡ºæˆåŠŸ
                        console.log("ç”¨æˆ¶å·²ç™»å‡º");
                        loginEmail = null; // æ¸…é™¤ç™»å…¥ç‹€æ…‹
                        renderNavTabs(); // é‡æ–°æ¸²æŸ“å°è¦½åˆ—ç‚ºæœªç™»å…¥ç‹€æ…‹
                        showSection("souvenir"); // é¡¯ç¤ºç´€å¿µå“å€å¡Š
                    }).catch((error) => {
                        // ç™»å‡ºå¤±æ•—
                        console.error("ç™»å‡ºå¤±æ•—:", error);
                    });
                } else {
                    // å¦‚æœé»æ“Šçš„æ˜¯å…§éƒ¨å€å¡Šåˆ‡æ›é€£çµ
                    showSection(id); // é¡¯ç¤ºå°æ‡‰çš„å€å¡Š
                }
            }
        });

        let souvenirDataTable = null; // å„²å­˜ç´€å¿µå“è¡¨æ ¼çš„ DataTables å¯¦ä¾‹
        let recommendDataTable = null; // å„²å­˜æ¨è–¦æ¸…å–®è¡¨æ ¼çš„ DataTables å¯¦ä¾‹

        // DataTables ç¹é«”ä¸­æ–‡èªç³»é…ç½®
        const dataTablesZhHant = {
            "decimal": "",
            "emptyTable": "ç›®å‰æ²’æœ‰è³‡æ–™",
            "info": "é¡¯ç¤ºç¬¬ _START_ åˆ° _END_ ç­†è³‡æ–™ï¼Œå…± _TOTAL_ ç­†",
            "infoEmpty": "ç›®å‰æ²’æœ‰è³‡æ–™",
            "infoFiltered": "(å¾ _MAX_ ç­†è³‡æ–™ä¸­ç¯©é¸)",
            "infoPostFix": "",
            "thousands": ",",
            "lengthMenu": "é¡¯ç¤º _MENU_ ç­†è³‡æ–™",
            "loadingRecords": "è¼‰å…¥ä¸­...",
            "processing": "è™•ç†ä¸­...",
            "search": "æœå°‹:",
            "zeroRecords": "æ²’æœ‰ç¬¦åˆçš„çµæœ",
            "paginate": {
                "first": "é¦–é ",
                "last": "æœ«é ",
                "next": "ä¸‹ä¸€é ",
                "previous": "ä¸Šä¸€é "
            },
            "aria": {
                "sortAscending": ": å‡å†ªæ’åˆ—",
                "sortDescending": ": é™å†ªæ’åˆ—"
            }
        };

        // è¼‰å…¥ç´€å¿µå“è³‡æ–™ä¸¦åˆå§‹åŒ– DataTables
        function loadSouvenirData() {
            fetch('https://opensheet.elk.sh/1z4SqcpGbhVtb5I6hQZ5aI9PQTNt2_64-ZFdc0_cV3kE/ç´€å¿µå“è³‡è¨Š')
                .then(res => res.json()) // å°‡éŸ¿æ‡‰è§£æç‚º JSON æ ¼å¼
                .then(data => {
                    const tableElement = document.getElementById('souvenirTable'); // ç²å–ç´€å¿µå“è¡¨æ ¼å…ƒç´ 
                    if (tableElement) {
                        if (souvenirDataTable) { 
                            souvenirDataTable.destroy(); // å¦‚æœ DataTables å¯¦ä¾‹å·²å­˜åœ¨ï¼Œå‰‡å…ˆéŠ·æ¯€å®ƒï¼Œä»¥ä¾¿é‡æ–°åˆå§‹åŒ–
                        }
                        tableElement.querySelector('tbody').innerHTML = ''; // æ¸…ç©ºè¡¨æ ¼ tbody å…§å®¹
                        tableElement.querySelector('thead').innerHTML = ''; // æ¸…ç©ºè¡¨æ ¼ thead å…§å®¹

                        if (data && data.length > 0) {
                            const headers = Object.keys(data[0]); // å¾ç¬¬ä¸€è¡Œæ•¸æ“šä¸­æå–æ‰€æœ‰éµä½œç‚ºè¡¨é ­
                            // ç”Ÿæˆè¡¨é ­çš„ HTML
                            const thead = headers.map(h => `<th>${h}</th>`).join('');
                            // ç”Ÿæˆè¡¨èº«çš„ HTML
                            const tbody = data.map(row => `<tr>${headers.map(k => `<td>${row[k]}</td>`).join('')}</tr>`).join('');
                            
                            tableElement.querySelector('thead').innerHTML = `<tr>${thead}</tr>`; // å°‡è¡¨é ­æ’å…¥åˆ°è¡¨æ ¼ä¸­
                            tableElement.querySelector('tbody').innerHTML = tbody; // å°‡è¡¨èº«æ•¸æ“šæ’å…¥åˆ°è¡¨æ ¼ä¸­

                            // åˆå§‹åŒ– DataTables
                            souvenirDataTable = $('#souvenirTable').DataTable({
                                destroy: true, // å…è¨±é‡æ–°åˆå§‹åŒ– DataTables (é‡è¦ï¼Œå› ç‚ºè¡¨æ ¼å…§å®¹æœƒå‹•æ…‹æ›´æ–°)
                                language: dataTablesZhHant, // è¨­å®šç‚ºç¹é«”ä¸­æ–‡èªç³»
                                paging: true,       // å•Ÿç”¨åˆ†é åŠŸèƒ½
                                searching: true,    // å•Ÿç”¨æœå°‹åŠŸèƒ½
                                info: true,         // å•Ÿç”¨é¡¯ç¤ºè³‡æ–™ä¿¡æ¯ (ä¾‹å¦‚ "é¡¯ç¤ºç¬¬ X åˆ° Y ç­†è³‡æ–™")
                                ordering: true,     // å•Ÿç”¨æ’åºåŠŸèƒ½
                                scrollX: true,      // å•Ÿç”¨æ°´å¹³æ»¾å‹•æ¢ï¼Œç•¶è¡¨æ ¼å…§å®¹è¶…å‡ºå®¹å™¨å¯¬åº¦æ™‚é¡¯ç¤º
                                autoWidth: false,   // ç¦ç”¨è‡ªå‹•åˆ—å¯¬ï¼Œè®“ CSS æ§åˆ¶æˆ–æ‰‹å‹•è¨­å®šåˆ—å¯¬
                                scrollCollapse: true, // å•Ÿç”¨æ»¾å‹•å¡Œé™·ï¼Œè®“è¡¨æ ¼åœ¨æ»¾å‹•æ™‚é«˜åº¦é©æ‡‰
                                initComplete: function(settings, json) {
                                    // DataTables åˆå§‹åŒ–å®Œæˆå¾Œçš„å›èª¿å‡½æ•¸
                                    // èª¿æ•´æ‰€æœ‰ DataTables å¯¦ä¾‹çš„åˆ—å¯¬ï¼Œç¢ºä¿è¡¨æ ¼å°é½Š
                                    $($.fn.dataTable.tables(true)).DataTable().columns.adjust();
                                }
                            });
                        } else {
                            // å¦‚æœæ²’æœ‰æ•¸æ“šï¼Œå‰‡é¡¯ç¤ºã€Œæ²’æœ‰å¯ç”¨çš„è³‡æ–™ã€
                            tableElement.querySelector('thead').innerHTML = '';
                            tableElement.querySelector('tbody').innerHTML = '<tr><td colspan="100%">æ²’æœ‰å¯ç”¨çš„è³‡æ–™</td></tr>';
                            souvenirDataTable = null; // æ¸…é™¤ DataTables å¯¦ä¾‹
                        }
                    }
                })
                .catch(error => console.error('è¼‰å…¥ç´€å¿µå“è³‡æ–™æ™‚ç™¼ç”ŸéŒ¯èª¤:', error)); // æ•ç²ä¸¦æ‰“å°éŒ¯èª¤
        }

        // è¼‰å…¥æ¨è–¦æ¸…å–®è³‡æ–™ä¸¦åˆå§‹åŒ– DataTables
        function loadRecommend(sheetName) {
            // æ§‹å»º OpenSheet URLï¼Œä½¿ç”¨ encodeURIComponent ç¢ºä¿å·¥ä½œè¡¨åç¨±ä¸­çš„ç‰¹æ®Šå­—ç¬¦è¢«æ­£ç¢ºç·¨ç¢¼
            const url = `https://opensheet.elk.sh/1WNSOI3l4AVk2h1kY0qj7xu4-9YdU_2fEj8xUf7lUSZk/${encodeURIComponent(sheetName)}`;
            fetch(url)
                .then(res => res.json())
                .then(data => {
                    const tableElement = document.getElementById('recommendTable'); // ç²å–æ¨è–¦æ¸…å–®è¡¨æ ¼å…ƒç´ 
                    if (tableElement) {
                        if (recommendDataTable) { 
                            recommendDataTable.destroy(); // å¦‚æœ DataTables å¯¦ä¾‹å·²å­˜åœ¨ï¼Œå‰‡å…ˆéŠ·æ¯€å®ƒ
                        }
                        tableElement.querySelector('tbody').innerHTML = ''; // æ¸…ç©ºè¡¨æ ¼ tbody å…§å®¹
                        tableElement.querySelector('thead').innerHTML = ''; // æ¸…ç©ºè¡¨æ ¼ thead å…§å®¹

                        if (data && data.length > 0) {
                            const headers = Object.keys(data[0]); // å¾ç¬¬ä¸€è¡Œæ•¸æ“šä¸­æå–æ‰€æœ‰éµä½œç‚ºè¡¨é ­
                            const thead = headers.map(h => `<th>${h}</th>`).join('');
                            const tbody = data.map(row => `<tr>${headers.map(k => `<td>${row[k]}</td>`).join('')}</tr>`).join('');
                            
                            tableElement.querySelector('thead').innerHTML = `<tr>${thead}</tr>`;
                            tableElement.querySelector('tbody').innerHTML = tbody;

                            // åˆå§‹åŒ– DataTables
                            recommendDataTable = $('#recommendTable').DataTable({
                                destroy: true, // å…è¨±é‡æ–°åˆå§‹åŒ–
                                searching: false, // æ¨è–¦æ¸…å–®ä¸å•Ÿç”¨æœå°‹åŠŸèƒ½
                                paging: false,    // æ¨è–¦æ¸…å–®ä¸å•Ÿç”¨åˆ†é åŠŸèƒ½
                                info: false,      // æ¨è–¦æ¸…å–®ä¸é¡¯ç¤ºè³‡æ–™ä¿¡æ¯
                                language: dataTablesZhHant, // è¨­å®šç‚ºç¹é«”ä¸­æ–‡èªç³»
                                ordering: true,   // å•Ÿç”¨æ’åºåŠŸèƒ½
                                scrollX: true,    // å•Ÿç”¨æ°´å¹³æ»¾å‹•æ¢
                                autoWidth: false,   // ç¦ç”¨è‡ªå‹•åˆ—å¯¬
                                scrollCollapse: true, // å•Ÿç”¨æ»¾å‹•å¡Œé™·
                                initComplete: function(settings, json) {
                                    // DataTables åˆå§‹åŒ–å®Œæˆå¾Œï¼Œèª¿æ•´æ‰€æœ‰ DataTables å¯¦ä¾‹çš„åˆ—å¯¬
                                    $($.fn.dataTable.tables(true)).DataTable().columns.adjust();
                                }
                            });
                        } else {
                            // å¦‚æœæ²’æœ‰æ•¸æ“šï¼Œå‰‡é¡¯ç¤ºã€Œæ²’æœ‰å¯ç”¨çš„è³‡æ–™ã€
                            tableElement.querySelector('thead').innerHTML = '';
                            tableElement.querySelector('tbody').innerHTML = '<tr><td colspan="100%">æ²’æœ‰å¯ç”¨çš„è³‡æ–™</td></tr>';
                            recommendDataTable = null; // æ¸…é™¤ DataTables å¯¦ä¾‹
                        }
                    }
                })
                .catch(error => console.error('è¼‰å…¥æ¨è–¦æ¸…å–®è³‡æ–™æ™‚ç™¼ç”ŸéŒ¯èª¤:', error)); // æ•ç²ä¸¦æ‰“å°éŒ¯èª¤
        }

        // ç•¶ DOM å…§å®¹å®Œå…¨è¼‰å…¥å¾ŒåŸ·è¡Œ
        document.addEventListener('DOMContentLoaded', () => {
            // *** æ–°å¢çš„ä»£ç¢¼é–‹å§‹ (ç”¨æ–¼ä¿®å¾©åˆ†é æ ¼å­èƒŒæ™¯) ***
            // ç¦ç”¨ DataTables å° Bootstrap åˆ†é æŒ‰éˆ•æ¨£å¼çš„è‡ªå‹•æ‡‰ç”¨
            // é€™æœƒé˜»æ­¢ DataTables æ·»åŠ å¦‚ 'btn', 'btn-secondary' ç­‰ Bootstrap é¡åˆ°åˆ†é æŒ‰éˆ•ä¸Š
            $.extend(true, $.fn.dataTable.ext.classes, {
                "sPageButton": "paginate_button", // æ¢å¾©åˆ° DataTables è‡ªå·±çš„åŸºæœ¬é¡åï¼Œä¸å¸¶ btn btn-secondary
                "sPageButtonActive": "paginate_button current", // åŒä¸Š
                "sPageButtonDisabled": "paginate_button disabled" // åŒä¸Š
            });
            // *** æ–°å¢çš„ä»£ç¢¼çµæŸ ***

            // ç›£è½ Firebase èªè­‰ç‹€æ…‹çš„è®ŠåŒ–
            onAuthStateChanged(auth, (user) => {
                loginEmail = user ? user.email : null; // æ›´æ–°ç™»å…¥éƒµç®±ç‹€æ…‹
                console.log(loginEmail ? "âœ… å·²ç™»å…¥ï¼š" + loginEmail : "âš ï¸ å°šæœªç™»å…¥"); // æ‰“å°ç™»å…¥ç‹€æ…‹
                
                renderNavTabs(); // æ ¹æ“šç™»å…¥ç‹€æ…‹æ¸²æŸ“å°è¦½åˆ—
                showSection("souvenir"); // é è¨­é¡¯ç¤ºç´€å¿µå“å€å¡Š

                loadSouvenirData(); // é¦–æ¬¡è¼‰å…¥ç´€å¿µå“è³‡æ–™

                const recommendSheetSelect = document.getElementById('recommendSheet'); // ç²å–æ¨è–¦æ¸…å–®ä¸‹æ‹‰é¸å–®
                if (recommendSheetSelect) {
                    // ç‚ºä¸‹æ‹‰é¸å–®æ·»åŠ  'change' äº‹ä»¶ç›£è½å™¨
                    recommendSheetSelect.addEventListener('change', function () {
                        loadRecommend(this.value); // æ ¹æ“šé¸ä¸­çš„å€¼è¼‰å…¥å°æ‡‰çš„æ¨è–¦æ¸…å–®
                    });
                    loadRecommend('æˆ‘å…¨éƒ½è¦ï¼ˆä¸éœ€è­‰ä»¶ï¼‰'); // é è¨­è¼‰å…¥ã€Œæˆ‘å…¨éƒ½è¦ï¼ˆä¸éœ€è­‰ä»¶ï¼‰ã€
                }
            });
        });

        // ç›£è½è¦–çª—å¤§å°è®ŠåŒ–äº‹ä»¶ (ä½¿ç”¨ jQuery çš„ resize äº‹ä»¶)
        $(window).on('resize', function () {
            // ä½¿ç”¨ setTimeout é€²è¡Œå»¶é²è™•ç† (debounce)ï¼Œé¿å…åœ¨èª¿æ•´å¤§å°éç¨‹ä¸­é »ç¹è§¸ç™¼
            setTimeout(function() {
                // æª¢æŸ¥é é¢ä¸Šæ˜¯å¦æœ‰ DataTables å¯¦ä¾‹
                if ($.fn.dataTable.tables(true).length) { 
                    // èª¿æ•´æ‰€æœ‰ DataTables å¯¦ä¾‹çš„åˆ—å¯¬ï¼Œç¢ºä¿åœ¨è¦–çª—å¤§å°è®ŠåŒ–æ™‚è¡¨æ ¼ä½ˆå±€æ­£ç¢º
                    $($.fn.dataTable.tables(true)).DataTable().columns.adjust();
                }
            }, 100); // å»¶é² 100 æ¯«ç§’åŸ·è¡Œ
        });
    </script>
</body>
</html>
