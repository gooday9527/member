<script>
  const loginEmail = localStorage.getItem("loginEmail");
  const navTabs = document.getElementById("nav-tabs");
  const contentArea = document.getElementById("content-area");

  const tabsBeforeLogin = [
    { id: "login", label: "登入" }
    { id: "register", label: "註冊" },
    { id: "about", label: "關於我" },
    { id: "notice", label: "注意事項" },
    { id: "recommend", label: "推薦清單" },
    { id: "souvenir", label: "紀念品" },    
  ];

  const tabsAfterLogin = [
    { id: "logout", label: "登出" }
    { id: "account", label: "帳號/持股" },
    { id: "about", label: "關於我" },
    { id: "notice", label: "注意事項" },
    { id: "recommend", label: "推薦清單" },
    { id: "delegation", label: "委託管理" },
    { id: "manage", label: "紀念品管理" },
    { id: "billing", label: "帳戶管理" },
    { id: "souvenir", label: "紀念品" },
    { id: "announcement", label: "公告欄" },
  ];

  function renderNavTabs() {
    navTabs.innerHTML = "";
    const tabs = loginEmail ? tabsAfterLogin : tabsBeforeLogin;
    tabs.forEach(tab => {
      const li = document.createElement("li");
      li.className = "nav-item";
      li.innerHTML = `<a class="nav-link" href="#" data-id="${tab.id}">${tab.label}</a>`;
      navTabs.appendChild(li);
    });
  }

  // 點擊分頁切換內容
  navTabs.addEventListener("click", async e => {
    if (e.target.matches(".nav-link")) {
      const id = e.target.dataset.id;
      if (id === "logout") {
        localStorage.removeItem("loginEmail");
        location.reload();
      } else {
        loadContent(id);
      }
    }
  });

  // 載入內容區塊
  async function loadContent(id) {
    if (id === "souvenir") {
      const html = await fetch("souvenir.html").then(r => r.text());
      contentArea.innerHTML = html;
    } else if (id === "recommend") {
      const html = await fetch("recommend.html").then(r => r.text());
      contentArea.innerHTML = html;
    } else {
      contentArea.innerHTML = `<h4>${id} 頁面尚未定義</h4>`;
    }
  }

  // 預設載入
  renderNavTabs();
  loadContent("souvenir");
</script>
